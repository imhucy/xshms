<!--Start Breadcrumb-->
<div class="row">
	<div id="breadcrumb" class="col-xs-12">
		<ol class="breadcrumb">
			<li><a href="index.html">主 页</a></li>
			<li><a href="javascript:;">系统管理</a></li>
			<li><a href="javascript:;">导入学生信息</a></li>
		</ol>
	</div>
</div>
<!--End Breadcrumb-->
<div class="row">
	<div class="col-xs-12">
		<div class="box">
			<div class="box-content">
				<form class="form-signin" role="form" method="post" action="/exportStudent" target="frameFile" enctype='multipart/form-data'>
			  <h2 class="form-signin-heading">上传导入文件</h2>
			  <br>
			  <div class="form-group">
			  	<label for="fulAvatar">请选择导入文件</label>
			  	<input id="fulAvatar" name="fulAvatar" type="file" class="form-control" />	 
			  </div>
			  <br/>
			  <input id="btnSub" class="btn btn-info" type="submit" value="点击导入" />
			</form>
			<div id="container">
				<iframe id='frameFile' name='frameFile' style="width:100%" ></iframe>
			</div>
			</div>
		</div>
	</div>
</div>

<script type="text/javascript">
String.prototype.format = function (args) {
  var result = this;
  if (arguments.length > 0) {
    if (arguments.length == 1 && typeof (args) == "object") {
      for (var key in args) {
        if (args[key] != undefined) {
          var reg = new RegExp("({" + key + "})", "g");
          result = result.replace(reg, args[key]);
        }
      }
    }
    else {
      for (var i = 0; i < arguments.length; i++) {
        if (arguments[i] != undefined) {
          var reg = new RegExp("({)" + i + "(})", "g");
          result = result.replace(reg, arguments[i]);
        }
      }
    }
  }
  return result;
}
$(function(){
	$('.preloader').hide();
  $('#btnSub').on('click',function(){		   
    var fulAvatarVal = $('#fulAvatar').val(),  
      errorTip = '<div id="errorTip" class="alert alert-warning">{0}</div> ';  

    $("#errorTip,#alt_warning").remove();
    
    if(fulAvatarVal.length == 0)
    {
      $("#container").prepend(errorTip.format('请选择要上传的文件'));								
      return false;
    }

     var extName = fulAvatarVal.substring(fulAvatarVal.lastIndexOf('.'),fulAvatarVal.length).toLowerCase();

    if(extName != '.xlsx'){
       $("#container").prepend(errorTip.format('只支持xlsx格式文件'));
       return false;
    }
    
    return true;
  })
});
</script>